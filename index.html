<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ryan Salon - Home</title>
    <link rel="stylesheet" href="style2.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">Ryan Salon</div>
            <ul class="nav-menu">
                <li><a href="index.html" class="active">Home</a></li>
                <li><a href="treatment.html">Treatment</a></li>
                <li><a href="product.html">Product</a></li>
                <li><a href="profile.html">Profil</a></li>
                <li><a href="contact.html">Contact Us</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1>Selamat Datang di Ryan Salon</h1>
            <p class="hero-subtitle">Salon kecantikan terpercaya untuk penampilan terbaik Anda</p>
            
            <!-- Google Maps Rating -->
            <div class="rating-box">
  <div class="stars" id="ratingStars">â˜…â˜…â˜…â˜…â˜…</div>
  <p class="rating-text">
    <span id="ratingAngka">0.0</span> dari
    <span id="totalUlasan">0</span> ulasan
  </p>
</div>

        </div>
    </section>

    <!-- Salon Photos Section -->
    <section class="salon-photos">
        <div class="container">
            <h2>Galeri Salon Kami</h2>
            <div class="photo-grid">
                <div class="photo-placeholder"><img src="galerisalon1.png" alt="Interior Ryan Salon"></div>
                <div class="photo-placeholder"><img src="galerisalon2.png" alt="Interior Ryan Salon"></div>
                <div class="photo-placeholder"><img src="galerisalon3.png" alt="Interior Ryan Salon"></div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="testimonials">
        <div class="testimonial-grid"></div>
    </section>
<section class="review-form">
  <div class="container">
    <h2>Kirim Ulasan Anda</h2>
    <form id="ulasanForm">
      <input type="text" id="nama" placeholder="Nama" required>
      <div class="rating-input">
  <input type="hidden" id="rating" required>

  <span class="star" data-value="1">â˜…</span>
  <span class="star" data-value="2">â˜…</span>
  <span class="star" data-value="3">â˜…</span>
  <span class="star" data-value="4">â˜…</span>
  <span class="star" data-value="5">â˜…</span>
</div>

      <textarea id="pesan" placeholder="Ulasan Anda" required></textarea>
      <button type="submit">Kirim Ulasan</button>
    </form>
  </div>
</section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-address">
                    <p>ğŸ“ Jl. Ki Mansyur, Babatan, Kec. Kadugede, Kabupaten Kuningan, Jawa Barat 45561</p>
                </div>
                <div class="footer-button">
                    <!-- TODO: Ganti link WhatsApp dengan nomor yang sebenarnya -->
                    <!-- <a href="https://wa.me/6281210973438" class="btn-whatsapp" target="_blank">ğŸ’¬ WhatsApp</a> -->
                    <a href="https://wa.me/6281210973438?text=Halo%20Ryan%20Salon%2C%20saya%20ingin%20booking"
                    class="btn-whatsapp"
                    target="_blank"> ğŸ’¬ WhatsApp
                    </a>
                </div>
            </div>
        </div>
    </footer>

<script>
/* =========================
   URL WEB APP GOOGLE APPS SCRIPT
   Ini adalah endpoint untuk kirim dan ambil data Spreadsheet
========================= */
const scriptURL = "https://script.google.com/macros/s/AKfycbz46TYUZyQ9pURBUlYwTi7SRHKPDbYNRiuLqNJGqcDsYtYcE_HOwGRHFvpq8g8xXnD3/exec";

/* =========================
   AMBIL ELEMEN HTML
   Semua ini diambil dari id dan class di HTML
========================= */
const form = document.getElementById("ulasanForm");
const container = document.querySelector(".testimonial-grid");
const totalEl = document.getElementById("totalUlasan");
const ratingAngkaEl = document.getElementById("ratingAngka");
const ratingStarsEl = document.getElementById("ratingStars");
const btn = form.querySelector("button");

const namaInput = document.getElementById("nama");
const ratingInput = document.getElementById("rating");
const pesanInput = document.getElementById("pesan");

/* =========================
   TEMPAT SIMPAN DATA ULASAN
========================= */
let dataUlasan = [];
/* =========================
   FUNGSI AMBIL DATA DARI SPREADSHEET
   Method GET
========================= */
function loadUlasan() {
  fetch(scriptURL + "?t=" + Date.now())
    .then(res => res.json())
    .then(data => {
      dataUlasan = data;
      renderUlasan();
    })
    .catch(err => {
      console.log("Gagal load data", err);
    });
}

/* =========================
   FUNGSI TAMPILKAN ULASAN KE HALAMAN
========================= */
function renderUlasan() {
  container.innerHTML = "";

  // Hitung total ulasan
  const total = dataUlasan.length;
  totalEl.innerText = total;

  // Hitung rating rata-rata
  let sum = 0;
  dataUlasan.forEach(d => sum += Number(d.rating));
  const avg = total ? (sum / total).toFixed(1) : "0.0";

  ratingAngkaEl.innerText = avg;
  ratingStarsEl.innerText = "â˜…".repeat(Math.round(avg));

  // Tampilkan 5 ulasan terbaru
  dataUlasan.slice(-5).reverse().forEach(u => {
    const div = document.createElement("div");
    div.className = "testimonial-card";
    div.innerHTML = `
      <div class="stars">${"â˜…".repeat(u.rating)}</div>
      <p class="testimonial-text">"${u.pesan}"</p>
      <p class="customer-name">- ${u.nama}</p>
    `;
    container.appendChild(div);
  });
}
/* =========================
   EVENT SAAT FORM DI-SUBMIT
   Method POST ke Spreadsheet
========================= */
form.addEventListener("submit", function(e) {
  e.preventDefault();

  btn.disabled = true;
  btn.innerText = "Mengirim...";

  const data = {
    nama: namaInput.value,
    rating: ratingInput.value,
    pesan: pesanInput.value
  };

  fetch(scriptURL, {
  method: "POST",
  body: JSON.stringify(data)
})

  .then(res => res.text())
  .then(() => {
    form.reset();
    loadUlasan();
    btn.disabled = false;
    btn.innerText = "Kirim Ulasan";
    alert("Ulasan berhasil dikirim");
  })
  .catch(err => {
    console.log("Gagal kirim", err);
    btn.disabled = false;
    btn.innerText = "Kirim Ulasan";
    alert("Gagal mengirim ulasan");
  });
});

/* =========================
   LOAD DATA SAAT HALAMAN DIBUKA
   AUTO REFRESH SETIAP 3 DETIK
========================= */
loadUlasan();
setInterval(loadUlasan, 3000);

const stars = document.querySelectorAll(".rating-input .star");
let selectedRating = 0;
let locked = false;

stars.forEach(star => {
  star.addEventListener("mouseover", () => {
    if (locked) return;
    const val = star.dataset.value;
    highlight(val);
  });

  star.addEventListener("mouseout", () => {
    if (locked) return;
    highlight(0);
  });

  star.addEventListener("click", () => {
    selectedRating = star.dataset.value;
    locked = true;
    document.getElementById("rating").value = selectedRating;
    highlight(selectedRating);
  });
});

function highlight(val) {
  stars.forEach(star => {
    if (star.dataset.value <= val) {
      star.classList.add("active");
    } else {
      star.classList.remove("active");
    }
  });
}

</script>
</body>
</html>